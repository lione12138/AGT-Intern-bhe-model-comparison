# MODFLOW网格离散化策略对比分析

## 1. 研究背景

在使用MODFLOW 6 GWE模块模拟地埋管换热器(BHE)时，网格离散化是影响模拟精度的关键因素。由于MODFLOW采用有限差分法，温度计算点位于网格单元中心，而非钻孔壁面。这导致模拟温度与实际钻孔壁面温度存在系统性偏差。

### 1.1 问题描述

BHE模拟中的核心问题是**网格等效半径**与**钻孔实际半径**的差异：

- 对于正方形网格单元（边长 $\Delta x$），等效半径为：
  $$r_{eq} = \sqrt{\frac{\Delta x^2}{\pi}}$$

- 钻孔实际半径：$r_b = 0.07$ m

- 当 $r_{eq} >> r_b$ 时，模拟温度偏离实际值

### 1.2 研究目标

比较三种网格策略的精度和计算效率：
1. 均匀粗网格（1.0m × 1.0m）
2. 均匀细网格（0.5m × 0.5m）
3. 局部加密网格（BHE处0.25m，远处2.0m）

## 2. 模型配置

### 2.1 BHE场地参数

| 参数 | 数值 | 单位 |
|------|------|------|
| 钻孔数量 | 40 (5×8) | - |
| 钻孔深度 H | 147 | m |
| 钻孔间距 B | 7.0 | m |
| 钻孔半径 r_b | 0.07 | m |
| 钻孔热阻 R_b | 0.1271 | (m·K)/W |

### 2.2 热物性参数

| 参数 | 数值 | 单位 |
|------|------|------|
| 导热系数 k | 1.4 | W/(m·K) |
| 体积热容 ρc | 2.83 | MJ/(m³·K) |
| 有效地温 T₀ | 13.28 | °C |

### 2.3 模拟时间

- 模拟周期：25年（300个应力期）
- 时间步长：1个月

## 3. 网格策略对比

### 3.1 三种网格方案

#### 方案1：均匀1.0m网格

```
网格尺寸：1.0m × 1.0m × 5.0m
总单元数：629,376
等效半径：r_eq = 0.564 m
r_eq/r_b = 8.1
```

#### 方案2：均匀0.5m网格

```
网格尺寸：0.5m × 0.5m × 5.0m
总单元数：2,517,504
等效半径：r_eq = 0.282 m
r_eq/r_b = 4.0
```

#### 方案3：局部加密网格

```
BHE处网格：0.25m × 0.25m
过渡区：0.5m（距BHE 1-3m）
中间区：1.0m（距BHE 3-10m）
边界区：2.0m（距BHE >10m）
总单元数：720,852
BHE处等效半径：r_eq = 0.141 m
r_eq/r_b = 2.0
```

### 3.2 网格热阻分析

网格离散化引入的额外热阻计算公式：

$$R_{grid} = \frac{\ln(r_{eq}/r_b)}{2\pi k}$$

| 网格方案 | r_eq [m] | R_grid [(m·K)/W] |
|----------|----------|------------------|
| 均匀1.0m | 0.564 | 0.2372 |
| 均匀0.5m | 0.282 | 0.1584 |
| 局部加密 | 0.141 | 0.0796 |

## 4. 结果对比

### 4.1 精度对比

与EED解析解对比结果：

| 指标 | 均匀1.0m | 均匀0.5m | 局部加密 |
|------|----------|----------|----------|
| **MAE [°C]** | 0.670 | 0.349 | **0.084** |
| **R²** | 0.9884 | 0.9965 | **0.9987** |
| 精度改善 | 基准 | 48% | **87%** |

![三种网格策略对比](../figures/grid_comparison_comprehensive.png)
*图1: 三种网格策略的温度模拟结果对比*

### 4.2 计算效率对比

| 指标 | 均匀1.0m | 均匀0.5m | 局部加密 |
|------|----------|----------|----------|
| 单元数 | 629,376 | 2,517,504 | 720,852 |
| 单元比例 | 1.0x | 4.0x | 1.15x |
| 计算时间 [min] | ~21 | ~77 | ~24 |
| 时间比例 | 1.0x | 3.7x | 1.1x |

### 4.3 效率指标

定义效率指标：精度提升/计算成本增加

$$\eta = \frac{1/MAE}{N_{cells}/10^6}$$

| 网格方案 | 效率指标 η |
|----------|-----------|
| 均匀1.0m | 2.37 |
| 均匀0.5m | 1.14 |
| **局部加密** | **16.52** |

**局部加密网格的效率是均匀粗网格的7倍，均匀细网格的14倍！**

## 5. 第25年月度温度对比

| 月份 | EED [°C] | 均匀1.0m | 局部加密 | 局部加密偏差 |
|------|----------|----------|----------|--------------|
| JAN | 10.5 | 11.3 | 10.5 | -0.03 |
| FEB | 10.6 | 11.4 | 10.6 | -0.01 |
| MAR | 11.3 | 12.0 | 11.4 | +0.05 |
| APR | 12.3 | 12.8 | 12.2 | -0.07 |
| MAY | 13.0 | 13.3 | 12.9 | -0.13 |
| JUN | 15.4 | 15.3 | 15.2 | -0.17 |
| JUL | 17.9 | 17.0 | 17.8 | -0.09 |
| AUG | 18.2 | 16.7 | 18.2 | +0.05 |
| SEP | 13.9 | 13.3 | 14.0 | +0.06 |
| OCT | 12.7 | 12.4 | 12.8 | +0.06 |
| NOV | 12.0 | 12.0 | 12.0 | -0.02 |
| DEC | 10.9 | 11.7 | 11.0 | +0.06 |

## 6. 峰值负荷温度

### 6.1 峰值负荷条件
- 峰值功率：160 kW
- 峰值线热流：27.2 W/m

### 6.2 第25年峰值温度

| 工况 | EED | 局部加密MODFLOW | 偏差 |
|------|-----|-----------------|------|
| 冬季峰值(1月) | 6.91°C | 7.01°C | +0.10°C |
| 夏季峰值(8月) | 22.40°C | 21.71°C | -0.69°C |

![MODFLOW局部加密与EED 25年对比](../figures/modflow_localref_eed_comparison.png)
*图2: MODFLOW局部加密网格与EED 25年温度时程对比*

## 7. 结论与建议

### 7.1 主要结论

1. **均匀1.0m网格**：精度较低（MAE=0.67°C），但计算效率高，适用于初步设计和快速评估。

2. **均匀0.5m网格**：精度提升48%，但计算成本增加4倍，性价比不高。

3. **局部加密网格**：
   - 精度最高（MAE=0.084°C，提升87%）
   - 计算成本仅增加15%
   - 无需任何数值校正，使用实际钻孔热阻
   - **最佳性价比方案**

### 7.2 物理解释

局部加密网格有效的原因：

1. 在BHE附近（温度梯度最大区域）使用细网格，准确捕捉热传递过程
2. 在远离BHE区域（温度梯度较小）使用粗网格，节省计算资源
3. 减小了等效半径 $r_{eq}$，使其更接近实际钻孔半径 $r_b$
4. 降低了网格离散化引入的额外热阻 $R_{grid}$

### 7.3 建议

对于BHE场地的MODFLOW模拟：

1. **推荐使用局部加密网格策略**
2. BHE位置网格尺寸建议：≤0.25m
3. 过渡区域网格尺寸：0.5-1.0m
4. 边界区域网格尺寸：1.0-2.0m
5. 使用实际钻孔热阻 $R_b$，无需额外校正

## 8. 文件说明

### 8.1 相关文件

| 文件 | 说明 |
|------|------|
| `modflow_bhe.ipynb` | 原始1.0m均匀网格模型 |
| `modflow_finegrid.ipynb` | 0.5m均匀细网格模型 |
| `modflow_localrefined.ipynb` | 局部加密网格模型（本文档对应） |
| `figures/grid_comparison_comprehensive.png` | 综合对比图 |
| `figures/modflow_localref_eed_comparison.png` | 局部加密模型时程图 |

### 8.2 数据文件

模拟结果保存在：
- `workspace/modflow_eed/` - 1.0m网格结果
- `D:/modflow_temp/modflow_localref/` - 局部加密网格结果

## 9. 参考文献

1. MODFLOW 6 GWE Module Documentation
2. EED (Earth Energy Designer) Software
3. Hellström, G. (1991). Ground Heat Storage: Thermal Analyses of Duct Storage Systems

---

*文档生成日期：2025年12月*
*作者：Liuhuang Luo


