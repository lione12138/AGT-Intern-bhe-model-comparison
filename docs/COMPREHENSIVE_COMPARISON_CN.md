# BHE场热响应模型综合对比分析

## POINT2 解析解 vs MODFLOW 数值解 vs EED 设计软件

---

## 摘要

本文档对三种BHE（地埋管换热器）场热响应计算方法进行了系统对比分析：
1. **EED (Earth Energy Designer)** - 工业标准设计软件，基于g-function方法，不考虑地下水流动
2. **POINT2 解析解** - 基于Wexler (1992)点源叠加法，考虑地下水流动的对流-扩散解析解
3. **MODFLOW-GWE 数值解** - 基于MODFLOW 6的地下水热传输数值模拟（纯数值方法）

在三种地下水流速场景（LOW: 0.001 m/d, MEDIUM: 0.1 m/d, HIGH: 1.0 m/d）下进行对比验证。

---

## 1. 模型概述

### 1.1 BHE场配置

| 参数 | 数值 | 单位 |
|------|------|------|
| 钻孔阵列 | 5 × 8 | - |
| 钻孔总数 | 40 | 个 |
| 钻孔深度 H | 147 | m |
| 钻孔间距 B | 7 | m |
| 钻孔半径 r_b | 0.07 | m |
| 钻孔热阻 R_b | 0.1271 | (m·K)/W |
| 有效地温 T₀_eff | 13.28 | °C |

### 1.2 热物性参数

| 参数 | 数值 | 单位 |
|------|------|------|
| 地层导热系数 k | 1.4 | W/(m·K) |
| 容积热容 ρc | 2.83 | MJ/(m³·K) |
| 孔隙度 n | 0.2 | - |
| 水力传导系数 K | 10 | m/d |

### 1.3 流速场景

| 场景 | Darcy流速 | 孔隙流速 | 物理意义 |
|------|-----------|----------|----------|
| **LOW** | 0.001 m/d | 0.005 m/d | 近似纯热传导 |
| **MEDIUM** | 0.1 m/d | 0.5 m/d | 中等对流效应 |
| **HIGH** | 1.0 m/d | 5.0 m/d | 强对流主导 |

### 1.4 月度热负荷

| 月份 | 建筑负荷 (MWh) | BHE负荷 (W/m) | 运行模式 |
|------|---------------|--------------|----------|
| SEP | 0 | 0 | 过渡期 |
| OCT | 7.37 | -1.72 | 供暖 |
| NOV | 12.3 | -2.87 | 供暖 |
| DEC | 19.6 | -4.57 | 供暖高峰 |
| JAN | 22.1 | -5.15 | 供暖高峰 |
| FEB | 19.6 | -4.57 | 供暖 |
| MAR | 12.3 | -2.87 | 供暖 |
| APR | 4.91 | -1.14 | 供暖 |
| MAY | 0 | 0 | 过渡期 |
| JUN | -19.6 | +4.57 | 制冷 |
| JUL | -39.2 | +9.13 | 制冷高峰 |
| AUG | -39.2 | +9.13 | 制冷高峰 |

---

## 2. 方法论对比

### 2.1 三种方法的特点

| 特性 | EED | POINT2 | MODFLOW-GWE |
|------|-----|--------|-------------|
| **方法类型** | 半解析(g-function) | 解析解 | 有限差分数值解 |
| **地下水流动** | ❌ 不考虑 | ✅ 考虑 | ✅ 考虑 |
| **热传导** | ✅ | ✅ | ✅ |
| **热对流** | ❌ | ✅ | ✅ |
| **计算速度** | 最快 | 快 | 较慢 |
| **空间分辨率** | 无 | 单点 | 全场 |
| **主要用途** | 工程设计 | 快速验证 | 详细分析 |

### 2.2 温度计算方法

**EED**：
```
T_fluid = T₀ + Δq × g(t/ts) / (2πk)
```
基于钻孔场的g-function响应函数。

**POINT2**：
```
T_borewall = POINT2(x, y, t, q, v, ...)
T_fluid = T_borewall + q × R_b
```
点源叠加 + 钻孔热阻转换。

**MODFLOW-GWE**：
```
∂T/∂t = ∇·(D∇T) - v·∇T + Q
T_fluid = T_cell + q × R_b
```
完整的对流-扩散方程数值求解。

---

## 3. 结果对比

### 3.1 流体温度范围对比（稳定后，最后5年）

| 方法 | 场景 | T_min [°C] | T_max [°C] | 振幅 [°C] |
|------|------|------------|------------|-----------|
| **EED** | (无流动) | 10.50 | 18.20 | 7.70 |
| **POINT2** | LOW | 10.29 | 18.47 | 8.19 |
| **POINT2** | MEDIUM | 10.69 | 17.83 | 7.14 |
| **POINT2** | HIGH | 11.11 | 16.05 | **4.93** |
| **MODFLOW** | LOW | 10.09 | 18.64 | 8.55 |
| **MODFLOW** | MEDIUM | 10.96 | 17.29 | 6.33 |
| **MODFLOW** | HIGH | 12.17 | 15.24 | **3.07** |

**关键发现**：两种方法都显示 **流速增加 → 振幅减小** 的正确物理趋势！

### 3.2 与EED的误差分析

| 方法 | 场景 | MAE [°C] | 计算时间 |
|------|------|----------|----------|
| **POINT2** | LOW | 0.00 | ~0.7 min |
| **POINT2** | MEDIUM | 0.32 | ~0.7 min |
| **POINT2** | HIGH | 0.31 | ~0.7 min |
| **MODFLOW** | LOW | 0.19 | ~35 min |
| **MODFLOW** | MEDIUM | 0.44 | ~39 min |
| **MODFLOW** | HIGH | 1.28 | ~47 min |

### 3.3 关键发现汇总表

| 指标 | LOW场景 | MEDIUM场景 | HIGH场景 | 趋势 |
|------|---------|------------|----------|------|
| **温度振幅变化** | 基准 | 减小13% | 减小27%* | 流速↑ → 振幅↓ |
| **POINT2-EED差异** | ~0°C | ~0.3°C | ~0.3°C | 稳定 |
| **MODFLOW-EED差异** | ~0.2°C | ~0.4°C | ~1.3°C | 流速↑ → 差异↑ |
| **POINT2 vs MODFLOW** | 接近 | 接近 | 有差异 | 高流速时diverge |

*注：振幅变化基于MODFLOW结果计算

---

## 4. 温度时序对比图

### 4.1 概述

以下图形对比了EED、POINT2和MODFLOW三种方法在三个流速场景下的25年温度时序。图中只显示基本负荷的流体温度曲线，不包含峰值负荷线。

### 4.2 LOW场景 (v = 0.001 m/d)

![3方法对比 LOW](../figures/comparison_3methods_low.png)

**误差分析（相对于EED）**：

| 方法 | MAE [°C] | 最大误差 [°C] | 趋势匹配 |
|------|----------|--------------|----------|
| POINT2 | 0.14 | 0.35 | ✅ 优秀 |
| MODFLOW | 0.19 | 0.44 | ✅ 优秀 |

**分析**：
- 低流速下三种方法高度一致
- 验证了方法的正确性 - 当v < 0.01 m/d时，对流效应可忽略
- POINT2和MODFLOW都能复现EED结果

### 4.3 MEDIUM场景 (v = 0.1 m/d)

![3方法对比 MEDIUM](../figures/comparison_3methods_medium.png)

**误差分析（相对于EED）**：

| 方法 | MAE [°C] | 最大误差 [°C] | 趋势匹配 |
|------|----------|--------------|----------|
| POINT2 | 0.23 | 0.58 | ✅ 良好 |
| MODFLOW | 0.44 | 0.91 | ✅ 良好 |

**分析**：
- 与EED相比，温度振幅开始减小
- POINT2和MODFLOW趋势一致（冬季低于EED，夏季高于EED）
- 中等流速下对流效应开始显现

### 4.4 HIGH场景 (v = 1.0 m/d)

![3方法对比 HIGH](../figures/comparison_3methods_high.png)

**误差分析（相对于EED）**：

| 方法 | MAE [°C] | 最大误差 [°C] | 趋势匹配 |
|------|----------|--------------|----------|
| POINT2 | 1.13 | 2.15 | ✅ 趋势正确 |
| MODFLOW | 1.28 | 2.96 | ✅ 趋势正确 |

**分析**：
- 两种方法的温度振幅都比EED显著减小
- POINT2振幅：~5°C；MODFLOW振幅：~3°C（而EED：~8°C）
- 对流成为主导传热机制
- 较高的MAE是合理的 - EED不考虑地下水流动，因此较大差异是物理上正确的

---

## 5. 温度场空间分布对比

### 5.1 温度等值线图概述

通过2D温度场等值线图直观展示不同流速下热羽的空间分布特征。以下图形展示了第1年8月末（夏季注热高峰后）的地温场分布。

### 5.2 LOW场景 (v = 0.001 m/d)

**POINT2温度场：**

![POINT2 LOW Contour](../figures/point2_gwflow_low_contour.png)

**MODFLOW温度场：**

![MODFLOW LOW Contour](../figures/modflow_gwflow_low_contour.png)

**分析**：
- **温度范围**：POINT2为11.0-15.5°C，MODFLOW类似
- **空间分布**：热场以BHE阵列为中心，基本对称分布
- **无明显热羽**：流速极低，对流效应可忽略
- **等值线特征**：同心圆状分布，符合纯热传导特性

### 5.3 MEDIUM场景 (v = 0.1 m/d)

**POINT2温度场：**

![POINT2 MEDIUM Contour](../figures/point2_gwflow_medium_contour.png)

**MODFLOW温度场：**

![MODFLOW MEDIUM Contour](../figures/modflow_gwflow_medium_contour.png)

**分析**：
- **温度范围**：POINT2为12.8-14.6°C（范围1.75°C）
- **热羽形态**：向下游（+X方向）明显延伸
- **不对称分布**：上游温度低，下游温度高
- **对流效应显著**：热量被地下水向下游输运

### 5.4 HIGH场景 (v = 1.0 m/d)

**POINT2温度场：**

![POINT2 HIGH Contour](../figures/point2_gwflow_high_contour.png)

**MODFLOW温度场：**

![MODFLOW HIGH Contour](../figures/modflow_gwflow_high_contour.png)

**分析**：
- **温度范围**：POINT2仅为13.3-13.8°C（范围**0.54°C**），MODFLOW类似
- **热羽被快速带走**：高流速下热量难以积累
- **温度场接近均匀**：整个BHE场温度变化<1°C
- **实际意义**：高地下水流速有利于BHE热性能

### 5.5 温度场对比总结

| 场景 | POINT2温度范围 | ΔT | 热羽特征 | 对称性 |
|------|----------------|-----|----------|--------|
| **LOW** | 11.0-15.5°C | ~4.5°C | 无明显热羽 | 对称 |
| **MEDIUM** | 12.8-14.6°C | ~1.8°C | 向下游延伸 | 不对称 |
| **HIGH** | 13.3-13.8°C | ~0.5°C | 热量快速扩散 | 弱不对称 |

**关键发现**：
1. **流速增加 → 温度场更均匀**：高流速下对流效应快速带走热量
2. **热羽形态演变**：从对称圆形 → 椭圆形延伸 → 近乎均匀
3. **工程意义**：高地下水流速场地的BHE效率更高，热积累风险更低

---

## 6. 物理机理分析

### 6.1 流速对热传输的影响

```
热传输总效应 = 热传导 + 热对流

Pe (Peclet数) = v·L / α

Pe << 1: 传导主导 (LOW场景)
Pe ~ 1:  混合传热 (MEDIUM场景)  
Pe >> 1: 对流主导 (HIGH场景)
```

### 6.2 温度振幅变化机理

| 流速增加的效应 | 结果 |
|---------------|------|
| 热量被更快带走 | 减少热积累 |
| 热羽向下游延伸 | 减少局部温升/温降 |
| 热平衡更快达到 | 温度更稳定 |
| **综合效果** | **温度振幅减小** |

### 6.3 HIGH场景温度极值月份偏移现象

在HIGH场景中观察到**温度极值发生在不同月份**的现象：

**观测事实**：
| 指标 | 预期月份 | 实际月份 (HIGH) |
|------|----------|-----------------|
| 最低温度 | JAN（峰值供暖负荷） | **DEC**（提前1个月） |
| 最高温度 | AUG（峰值制冷负荷） | **JUL**（提前1个月） |

**物理解释**：
1. **对流热传输改变响应特性** - 高流速下，热量传输更依赖对流而非传导
2. **热惯性与负荷时序** - 12月累积的供暖取热在1月峰值负荷叠加前已达到最低
3. **地下水带来的热量** - 高流速下上游的恒温地下水持续补充，使温度更快恢复

### 6.4 POINT2与MODFLOW振幅差异分析

两种方法在HIGH场景下振幅不同（POINT2: 4.93°C vs MODFLOW: 3.07°C）：

**关于MODFLOW模型维度的说明**：本研究使用的MODFLOW模型是**完整的33层三维模型**（每层5m厚，总深度167m）。这允许完整的垂直热传输，而不仅仅是水平对流。

| 差异来源 | POINT2 | MODFLOW |
|----------|--------|---------|
| **维度** | 2D平面解析解 | 3D体积数值解 |
| **域范围** | 无限域 | 有限边界 |
| **热传输** | 仅水平对流 | 三维对流+传导 |
| **热混合** | 受限于2D | 完整3D热混合 |

**为什么MODFLOW振幅更小？**
- 在33层的三维模型中，热量可以在三个方向上传导和对流
- 层之间的垂直热传输提供了额外的热混合
- 有限边界条件提供更好的热源/热汇
- 网格化的BHE具有更真实的体积效应
- 结果：更强的温度阻尼效应，振幅更小

### 6.5 相位偏移的时间演化

**问题**：为什么HIGH场景下前几年相位偏移不明显？

**观测结果**（POINT2 HIGH场景）：

| 年份 | 最低温月份 | 最高温月份 | 说明 |
|------|------------|------------|------|
| 第1年 | JAN | AUG | 与负荷同步 |
| 第2年 | JAN | JUL | MAX开始偏移 |
| 第3年+ | DEC | JUL | 稳定偏移模式 |

**物理解释**：
1. **初始条件效应**：第1年地温场为初始均匀温度，热羽刚开始形成
2. **热羽发展过程**：高流速下，热羽逐年向下游延伸
3. **特征时间**：水流穿越BHE场需要49天，建立稳定对流模式需要1-2年
4. **上游热量补给**：后几年上游恒温地下水持续流入，加速温度恢复

### 6.6 POINT2的3D扩展可行性

**问题**：POINT2能否优化到完整的3D热混合？

**结论**：技术上可行，但**不建议**实施。

| 方面 | 说明 |
|------|------|
| **理论基础** | Wexler (1992)包含POINT3（3D点源解），但BHE是线热源 |
| **正确方法** | 需要实现Moving Finite Line Source (MFLS)解析解 |
| **实现复杂度** | 涉及3重积分，计算量大幅增加 |
| **已有替代方案** | pygfunction（无地下水）+ MODFLOW（有地下水）已覆盖所有场景 |

**建议**：保持当前工具组合（pygfunction + MODFLOW），无需为POINT2开发3D扩展。

---

## 7. pygfunction：EED的开源替代方案

### 7.1 概述

**pygfunction** 是一个开源Python库，为BHE热响应计算提供了商业软件EED的替代方案。它基于Eskilson (1987) 和 Cimmino (2014) 的g函数方法论实现。

| 特性 | EED | pygfunction |
|------|-----|-------------|
| 许可证 | 商业 | 开源 (BSD) |
| 平台 | 仅Windows | 跨平台 (Windows/Mac/Linux) |
| 脚本化 | 有限 | 完整Python API |
| 成本 | 付费许可 | 免费 |
| 精度 | 参考标准 | 可比（MAE ≈ 0.15°C） |
| g函数访问 | 隐藏 | 完全可访问 |

### 7.2 什么是g函数？

g函数是一个无量纲热响应函数，用于表征钻孔场的热行为。它将钻孔壁的温度变化与取热/注热速率联系起来。

**我们40孔钻孔场的g函数曲线：**

![g函数曲线](../figures/gfunction_curve.png)

**关键g函数值：**

| 时间 | g值 | 物理意义 |
|------|-----|----------|
| 1个月 | 3.12 | 短期响应 |
| 1年 | 5.04 | 年周期 |
| 5年 | 10.21 | 中期 |
| 10年 | 14.48 | 长期 |
| 25年 | 23.61 | 设计周期 |

**特征时间**：$t_s = H^2/(9\alpha)$ = 153.8年

### 7.3 EED与pygfunction的联系

EED和pygfunction使用**相同的理论基础** - g函数方法：

$$T_{fluid} = T_0^{eff} + \frac{1}{2\pi k_s H} \sum_{i} \Delta q_i \cdot g(t-t_i) + q \cdot R_b$$

其中：
- $T_0^{eff} = T_{surface} + \frac{q_{geo}}{k_s} \cdot \frac{H}{2}$ = 13.28°C（有效初始地温）
- $g(t)$ 是由pygfunction计算的g函数
- $R_b$ = 0.1271 (m·K)/W 是来自EED的有效钻孔热阻

**实现过程中发现的关键校正：**

1. **热物性参数必须与EED输入一致**：k = 1.4 W/(m·K), ρc = 2.83 MJ/(m³·K)
2. **不能忽略地温梯度**：对于147m钻孔，这会使有效温度增加约3.7°C
3. **负荷符号约定不同**：pygfunction使用正值表示注热，与EED相反

### 7.4 pygfunction与EED验证结果

![pygfunction与EED对比](../figures/final_comparison_line_chart.png)

**月温度对比（第25年）：**

| 月份 | EED [°C] | pygfunction [°C] | 误差 [°C] |
|------|----------|------------------|-----------|
| 1月 | 10.50 | 10.66 | +0.16 |
| 2月 | 10.60 | 10.85 | +0.25 |
| 3月 | 11.30 | 11.62 | +0.32 |
| 4月 | 12.30 | 12.43 | +0.13 |
| 5月 | 13.00 | 12.98 | -0.02 |
| 6月 | 15.40 | 15.36 | -0.04 |
| 7月 | 17.90 | 17.76 | -0.14 |
| 8月 | 18.20 | 17.90 | -0.30 |
| 9月 | 13.90 | 13.86 | -0.04 |
| 10月 | 12.70 | 12.70 | 0.00 |
| 11月 | 12.00 | 12.03 | +0.03 |
| 12月 | 10.90 | 11.06 | +0.16 |

**误差统计：**

| 指标 | 数值 |
|------|------|
| MAE（平均绝对误差） | **0.15°C** |
| R²（决定系数） | **0.999** |
| 最大月误差 | 0.32°C |

### 7.5 pygfunction能否替代EED？

**结论：对于研究和脚本化工作流，可以！**

| 方面 | 评估 |
|------|------|
| **精度** | ✅ 优秀（MAE = 0.15°C，R² = 0.999） |
| **可重复性** | ✅ 基于代码，完全可重复 |
| **可扩展性** | ✅ 易于添加自定义配置 |
| **成本** | ✅ 免费、开源 |
| **学习曲线** | ⚠️ 需要Python知识 |
| **图形界面** | ❌ 无图形界面 |

**建议**：
- **工程设计**：EED仍然是行业标准，具有用户友好的界面
- **研究用途**：pygfunction因其透明性、可脚本化和可重复性而更受青睐
- **有地下水流的场地**：两者都不够用 - 需使用POINT2或MODFLOW

---

## 8. 计算效率对比

| 方法 | LOW | MEDIUM | HIGH | 硬件需求 |
|------|-----|--------|------|----------|
| **EED** | <1秒 | <1秒 | N/A | 低 |
| **POINT2** | ~0.7分钟 | ~0.7分钟 | ~0.7分钟 | 低 |
| **MODFLOW** | ~35分钟 | ~39分钟 | ~47分钟 | 中高 |

---

## 9. 各方法适用场景

### 9.1 推荐使用场景

| 方法 | 适用场景 | 不适用场景 |
|------|----------|------------|
| **EED** | 初步设计、无/低流速场地 | 高地下水流速场地 |
| **POINT2** | 快速流速敏感性分析、验证 | 需要详细场分布 |
| **MODFLOW** | 详细设计、复杂边界条件 | 快速估算 |

### 9.2 工程决策指南

```
流速判断标准:
├── v < 0.01 m/d → 使用EED足够准确
├── 0.01 < v < 0.5 m/d → 建议POINT2验证
└── v > 0.5 m/d → 推荐MODFLOW详细分析
```

---

## 10. 结论

### 10.1 主要发现

1. **方法验证成功**
   - LOW场景下三种方法结果一致
   - POINT2在低流速条件下与EED误差<0.2°C
   - 验证了POINT2 + R_b转换方法的正确性

2. **流速影响显著**
   - 流速从0.001增加到1.0 m/d
   - 温度振幅减少约27-32%
   - 高流速有利于BHE场热性能

3. **方法选择建议**
   - 低流速(v<0.01 m/d): EED足够
   - 中等流速(0.01-0.5 m/d): POINT2快速验证
   - 高流速(v>0.5 m/d): MODFLOW详细分析

### 10.2 方法特点总结

| 方法 | 优势 | 局限 |
|------|------|------|
| **EED** | 快速、工业标准 | 不考虑流动 |
| **POINT2** | 快速、考虑流动 | 仅单点、2D假设 |
| **MODFLOW** | 全面、3D详细 | 耗时、复杂 |

### 10.3 实际工程建议

对于存在地下水流动的BHE项目：

1. **场地勘察阶段**：测量地下水流速
2. **初步设计**：使用EED进行基本设计
3. **流速评估**：使用POINT2进行敏感性分析
4. **详细设计**：高流速场地使用MODFLOW
5. **运行优化**：考虑对流效应调整负荷策略

---

## 附录A：数据汇总表

### A.1 POINT2详细结果（稳定后，最后5年）

| 场景 | v [m/d] | Tf_min [°C] | Tf_max [°C] | 振幅 [°C] | MAE [°C] | 时间 [min] |
|------|---------|-------------|-------------|-----------|----------|------------|
| LOW | 0.001 | 10.29 | 18.47 | 8.19 | 0.00 | 0.70 |
| MEDIUM | 0.1 | 10.69 | 17.83 | 7.14 | 0.32 | 0.71 |
| HIGH | 1.0 | 11.11 | 16.05 | 4.93 | 0.31 | 0.72 |

### A.2 MODFLOW详细结果（稳定后，最后5年）

| 场景 | v [m/d] | Tf_min [°C] | Tf_max [°C] | 振幅 [°C] | MAE [°C] | 时间 [min] |
|------|---------|-------------|-------------|-----------|----------|------------|
| LOW | 0.001 | 10.09 | 18.64 | 8.55 | 0.19 | 35.1 |
| MEDIUM | 0.1 | 10.96 | 17.29 | 6.33 | 0.44 | 39.4 |
| HIGH | 1.0 | 12.17 | 15.24 | 3.07 | 1.28 | 46.8 |

### A.3 EED参考值

| 参数 | 数值 | 单位 |
|------|------|------|
| 月均温度范围 | 10.50 - 18.20 | °C |
| 峰值供暖温度 | 6.91 | °C |
| 峰值制冷温度 | 22.40 | °C |

---

*报告更新日期：2025年12月15日*

*方法参考：*
- *EED v4.0 (BLOCON)*
- *POINT2: Wexler (1992) USGS TWRI 03-B7*
- *MODFLOW 6 + GWE Package (USGS)*
